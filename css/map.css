/* css/map.css */

#map-screen { 
    flex-direction: column; 
    justify-content: flex-start; 
    align-items: flex-start; 
    padding: 0; 
    overflow: hidden;
}

/* DIŞ ÇERÇEVE: Sadece görünür alanı sınırlar ve scroll bar ekler */
#map-display { 
    position: relative; 
    width: 100%; 
    height: 75%; 
    overflow-x: auto; /* Yatay scroll */
    overflow-y: hidden;
    background-color: #111;
}

/* İÇERİK: Tüm harita elemanlarını tutan geniş kutu */
#map-content {
    position: relative;
    width: 200%; /* Harita ekranın 2 katı genişliğinde */
    height: 100%;
}

/* Arka plan artık map-content boyutuna uyacak */
#map-background { 
    width: 100%; 
    height: 100%; 
    object-fit: cover; 
    opacity: 0.4;
    position: absolute; /* Sabitle */
    top: 0; left: 0;
    z-index: 0;
}

/* SVG Katmanı */
#map-trails-layer { 
    position: absolute; 
    top: 0; left: 0; 
    width: 100%; 
    height: 100%; 
    z-index: 5; 
    pointer-events: none; 
}

/* Gidilen Yol (Kalıcı - Parlak Sarı) */
.map-trail-line {
    stroke: #ffd700; /* Altın Sarısı */
    stroke-width: 4; 
    stroke-dasharray: 10, 10;
    opacity: 1.0; /* Tam görünür */
    stroke-linecap: round; 
    animation: dash-animation 60s linear infinite;
    filter: drop-shadow(0 0 3px #000); /* Arkasına gölge attık ki belli olsun */
}

/* Gidilebilecek Yollar (Hint - Kesikli Gri/Beyaz) */
.map-path-hint {
     stroke: #cccccc; /* Hafif Gri */
     stroke-width: 3; /* Biraz kalınlaştırdık */
     stroke-dasharray: 5, 8;
     opacity: 0.6; /* Görünürlüğü artırdık */
     stroke-linecap: round;
     filter: drop-shadow(0 0 2px #000); /* Arkasına gölge attık */
}

@keyframes dash-animation { to { stroke-dashoffset: -1000; } }


/* Düğümler */
.map-node {
    position: absolute; 
    width: 50px; height: 50px; 
    border-radius: 50%; 
    padding: 0;
    background: #333; 
    border: 2px solid #777; 
    z-index: 10; 
    cursor: pointer;
    transition: transform 0.2s, box-shadow 0.2s;
    display: flex; justify-content: center; align-items: center;
}

.map-node:hover:not(:disabled) { 
    transform: scale(1.2); 
    box-shadow: 0 0 15px rgba(240, 230, 140, 0.8); 
    z-index: 15;
}

.map-node img { width: 70%; height: 70%; pointer-events: none; }

/* Node Renkleri */
.map-node.start-node { border-color: #fff; background: #555; }
.map-node.encounter-node { border-color: #ff4d4d; }
.map-node.campfire-node { border-color: #ffa500; }
.map-node.choice-node { border-color: #3498db; }
.map-node.town-node { border-color: #f0e68c; box-shadow: 0 0 10px #f0e68c; }
.map-node.boss-node { border-color: #ff0000; width: 70px; height: 70px; }
.map-node.city-node { border-color: #00ff00; width: 70px; height: 70px; }

/* Durumlar */
.map-node:disabled { filter: grayscale(100%) brightness(0.5); cursor: not-allowed; border-style: dashed; }
.map-node.available { filter: none; border-color: #43FF64; box-shadow: 0 0 10px #43FF64; animation: pulse-node 1.5s infinite; }
.map-node.visited { border-color: #ffd700; opacity: 0.6; }

@keyframes pulse-node { 0% { transform: scale(1); } 50% { transform: scale(1.1); } 100% { transform: scale(1); } }

/* Oyuncu İkonu */
#player-marker-container { 
    position: absolute; width: 50px; height: 50px; z-index: 20; 
    transition: left 0.5s ease-in-out, top 0.5s ease-in-out; 
    pointer-events: none; display: none; 
}
/* İkon Resmi Küçültme Düzeltmesi */
#player-marker { width: 100%; height: 100%; object-fit: contain; filter: drop-shadow(0 0 5px #f0e68c); }
/* --- MOBİL UYUMLULUK (MAP) --- */
@media (max-width: 768px) {
    /* Harita içeriğini mobilde daha geniş yap ki düğümler arası açılsın */
    #map-content {
        width: 300%; /* Masaüstünde 200% idi, mobilde 300% olsun */
    }

    .map-node {
        width: 60px; /* Parmakla basmak için büyüttük */
        height: 60px;
    }
    
    /* Boss ve City daha da büyük */
    .map-node.boss-node, .map-node.city-node {
        width: 80px;
        height: 80px;
    }
}