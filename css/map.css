/* css/map.css */

#map-screen { 
    flex-direction: column; 
    justify-content: flex-start; 
    align-items: flex-start; 
    padding: 0; 
    overflow: hidden;
}

/* DIŞ ÇERÇEVE: Sadece görünür alanı sınırlar ve scroll bar ekler */
#map-display { 
    position: relative; 
    width: 100%; 
    height: 100%; 
    overflow-x: auto; /* Yatay scroll */
    overflow-y: hidden;
    background-color: #111;
	/* --- SCROLLBAR GİZLEME (TÜM TARAYICILAR İÇİN) --- */
    -ms-overflow-style: none;  /* Internet Explorer ve Eski Edge */
    scrollbar-width: none;     /* Firefox */
}
/* Chrome, Safari ve Yeni Edge (Blink motoru) için */
#map-display::-webkit-scrollbar {
    display: none;
}
#map-display {
    cursor: grab; /* Harita üzerinde el simgesi çıksın */
}
#map-display:active {
    cursor: grabbing; /* Tutarken yumruk simgesi çıksın */
}

/* İÇERİK: Tüm harita elemanlarını tutan geniş kutu */
#map-content {
    position: relative;
    width: 200%; /* Harita ekranın 2 katı genişliğinde */
    height: 100%;
}

#map-info-box {
    position: absolute;
    bottom: 0;
    left: 50%;
    transform: translateX(-50%);
    width: 600px; /* Genişliği isteğine göre ayarla */
    background: rgba(20, 20, 20, 0.95);
    border: 2px solid #6b5c3b;
    border-bottom: none;
    border-radius: 15px 15px 0 0;
    z-index: 1000;
    transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    box-shadow: 0 -5px 25px rgba(0,0,0,0.8);
}

/* Kutu kapalıyken sadece başlık barı görünecek */
#map-info-box.collapsed {
    height: 45px; 
    overflow: hidden;
    background: rgba(10, 10, 10, 0.8);
}

#map-info-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 10px 20px;
    cursor: pointer;
    background: linear-gradient(to bottom, #2b2218, #1a150e);
    border-radius: 12px 12px 0 0;
}

#map-info-header h2 {
    margin: 0;
    font-size: 1.1em;
    color: #f0e68c;
    pointer-events: none;
}

#map-info-content {
    padding: 15px 25px;
    text-align: center;
}

/* Ok İkonu Animasyonu */
#info-arrow {
    transition: transform 0.4s;
    color: #f0e68c;
}
#map-info-box.collapsed #info-arrow {
    transform: rotate(180deg);
}

/* --- TİK KUTUSU (TOGGLE SWITCH) STİLİ --- */
.toggle-control { display: flex; align-items: center; gap: 15px; }
.switch { position: relative; display: inline-block; width: 40px; height: 20px; }
.switch input { opacity: 0; width: 0; height: 0; }
.slider { position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: #444; transition: .4s; border-radius: 34px; border: 1px solid #6b5c3b; }
.slider:before { position: absolute; content: ""; height: 14px; width: 14px; left: 3px; bottom: 2px; background-color: #f0e68c; transition: .4s; border-radius: 50%; }
input:checked + .slider { background-color: #5d4a30; }
input:checked + .slider:before { transform: translateX(20px); }

/* Arka plan artık map-content boyutuna uyacak */
#map-background { 
    width: 100%; 
    height: 100%; 
    object-fit: cover; 
    opacity: 0.4;
    position: absolute; /* Sabitle */
    top: 0; left: 0;
    z-index: 0;
}

/* SVG Katmanı */
#map-trails-layer { 
    position: absolute; 
    top: 0; left: 0; 
    width: 100%; 
    height: 100%; 
    z-index: 5; 
    pointer-events: none; 
}

/* Gidilen Yol (Kalıcı - Parlak Sarı) */
.map-trail-line {
    stroke: #ffd700; /* Altın Sarısı */
    stroke-width: 4; 
    stroke-dasharray: 10, 10;
    opacity: 1.0; /* Tam görünür */
    stroke-linecap: round; 
    animation: dash-animation 60s linear infinite;
    filter: drop-shadow(0 0 3px #000); /* Arkasına gölge attık ki belli olsun */
}

/* Gidilebilecek Yollar (Hint - Kesikli Gri/Beyaz) */
.map-path-hint {
     stroke: #cccccc; /* Hafif Gri */
     stroke-width: 3; /* Biraz kalınlaştırdık */
     stroke-dasharray: 5, 8;
     opacity: 0.6; /* Görünürlüğü artırdık */
     stroke-linecap: round;
     filter: drop-shadow(0 0 2px #000); /* Arkasına gölge attık */
}

@keyframes dash-animation { to { stroke-dashoffset: -1000; } }


/* Düğümler */
.map-node {
    position: absolute; 
    width: 50px; height: 50px; 
    border-radius: 50%; 
    padding: 0;
    background: #333; 
    border: 2px solid #777; 
    z-index: 10; 
    cursor: pointer;
    transition: transform 0.2s, box-shadow 0.2s;
    display: flex; justify-content: center; align-items: center;
}

.map-node:hover:not(:disabled) { 
    transform: scale(1.2); 
    box-shadow: 0 0 15px rgba(240, 230, 140, 0.8); 
    z-index: 15;
}

.map-node img { width: 70%; height: 70%; pointer-events: none; }

/* Node Renkleri */
.map-node.start-node { border-color: #fff; background: #555; }
.map-node.encounter-node { border-color: #ff4d4d; }
.map-node.campfire-node { border-color: #ffa500; }
.map-node.choice-node { border-color: #3498db; }
.map-node.town-node { border-color: #f0e68c; box-shadow: 0 0 10px #f0e68c; }
.map-node.boss-node { border-color: #ff0000; width: 70px; height: 70px; }
.map-node.city-node { border-color: #00ff00; width: 70px; height: 70px; }

/* Durumlar */
.map-node:disabled { filter: grayscale(100%) brightness(0.5); cursor: not-allowed; border-style: dashed; }
.map-node.available { filter: none; border-color: #43FF64; box-shadow: 0 0 10px #43FF64; animation: pulse-node 1.5s infinite; }
.map-node.visited { border-color: #ffd700; opacity: 0.6; }

@keyframes pulse-node { 0% { transform: scale(1); } 50% { transform: scale(1.1); } 100% { transform: scale(1); } }

/* Oyuncu İkonu */
#player-marker-container { 
    position: absolute; width: 50px; height: 50px; z-index: 20; 
    transition: left 0.5s ease-in-out, top 0.5s ease-in-out; 
    pointer-events: none; display: none; 
}
/* İkon Resmi Küçültme Düzeltmesi */
#player-marker { width: 100%; height: 100%; object-fit: contain; filter: drop-shadow(0 0 5px #f0e68c); }
/* --- MOBİL UYUMLULUK (MAP) --- */
@media (max-width: 768px) {
    /* Harita içeriğini mobilde daha geniş yap ki düğümler arası açılsın */
    #map-content {
        width: 300%; /* Masaüstünde 200% idi, mobilde 300% olsun */
    }

    .map-node {
        width: 60px; /* Parmakla basmak için büyüttük */
        height: 60px;
    }
    
    /* Boss ve City daha da büyük */
    .map-node.boss-node, .map-node.city-node {
        width: 80px;
        height: 80px;
    }
}
.map-node.hard-encounter {
    border-color: #ff9800 !important; /* Turuncu Çerçeve */
    box-shadow: 0 0 15px #ff9800 !important; /* Turuncu Parlama */
    animation: pulse-orange 2s infinite ease-in-out;
    z-index: 12; /* Diğerlerinden biraz üstte */
}

/* Kırmızı Boss ile karışmasın diye özel animasyon */
@keyframes pulse-orange {
    0% { transform: scale(1); box-shadow: 0 0 10px #ff9800; }
    50% { transform: scale(1.15); box-shadow: 0 0 25px #ff9800; }
    100% { transform: scale(1); box-shadow: 0 0 10px #ff9800; }
}